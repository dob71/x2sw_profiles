# .pronsolerc file for X2

# Support for both SF and Slic3r skeiners
!self.sf_slicecommand="python skeinforge/skeinforge_application/skeinforge_utilities/skeinforge_craft.py $s"
!self.sf_sliceoptscommand="python skeinforge/skeinforge_application/skeinforge.py"
!self.slic3rcmd = os.path.join(os.path.abspath(os.path.dirname(sys.argv[0])), 'slic3r','slic3r')
!if os.path.exists(os.path.join(os.path.abspath(os.path.dirname(sys.argv[0])), 'slic3r','slic3r.pl')): self.slic3rcmd = 'perl ' + os.path.join(os.path.abspath(os.path.dirname(sys.argv[0])), 'slic3r','slic3r.pl')
!self.slic3r_platercommand=self.slic3rcmd + " --gui --output $o"
!self.slic3r_slicecommand=self.slic3rcmd + " $s --output $o"
!self.slic3r_sliceoptscommand=self.slic3rcmd + " --no-plater"

macro fanoff
   M107

macro fan70
   M106
   !time.sleep(1.0)
   M106 S70

macro fan120
   M106
   !time.sleep(1.0)
   M106 S120

macro fan255
   M106

macro x2Merge
   !try:
   !    from X2MergeDialog import X2MergeDialog
   !    dlg = X2MergeDialog(self)
   !    res = dlg.ShowModal()
   !    if (res == 1):
   !         self.loadfile(None, filename=dlg.GetPath())
   !    if (res == 2):
   !         self.log(_("The merge has failed!"))
   !         self.statusbar.SetStatusText(_("The merge has failed!"))
   !except:
   !    self.log(_("The merge cannot be completed!"))
   !    self.statusbar.SetStatusText(_("The merge cannot be completed!"))
   !    pass

macro s3rPlater
   !try:
   !    self.slice(None, self.slic3r_platercommand)
   !except:
   !    self.log(_("Failed to start the Slic3r plater!"))
   !    self.statusbar.SetStatusText(_("Failed to start the Slic3r plater!"))
   !    pass

macro useSkeinforge
   !try:
   !  self.set("custom1", 0)
   !  self.settings.slicecommand = self.sf_slicecommand
   !  self.settings.sliceoptscommand = self.sf_sliceoptscommand
   !  self.statusbar.SetStatusText(_("Switched to Skeinforge"))
   !  self.onecmd('button 5 "Slic3r" /c lightgrey useSlic3r')
   !  self.onecmd('button 6 "Skeinforge" /c green useSkeinforge')
   !  self.onecmd('button 4 "X2Merge" /c lightgrey x2Merge')
   !except:
   !  self.statusbar.SetStatusText(_("Failed to change skeiner!"))
   !  pass

macro useSlic3r
   !try:
   !  self.set("custom1", 1)
   !  self.settings.slicecommand = self.slic3r_slicecommand
   !  self.settings.sliceoptscommand = self.slic3r_sliceoptscommand
   !  self.statusbar.SetStatusText(_("Switched to Slic3r"))
   !  self.onecmd('button 6 "Skeinforge" /c lightgrey useSkeinforge')
   !  self.onecmd('button 5 "Slic3r" /c green useSlic3r')
   !  self.onecmd('button 4 "S3rPlater" /c lightgrey s3rPlater')
   !except:
   !  self.statusbar.SetStatusText(_("Failed to change skeiner!"))
   !  pass

macro onLoadUI
   !try:
   !  if self.settings.custom1 == 0:
   !    self.settings.slicecommand = self.sf_slicecommand
   !    self.settings.sliceoptscommand = self.sf_sliceoptscommand
   !    self.onecmd('button 6 "Skeinforge" /c green useSkeinforge')
   !    self.onecmd('button 4 "X2Merge" /c lightgrey x2Merge')
   !  else:
   !    self.settings.slicecommand = self.slic3r_slicecommand
   !    self.settings.sliceoptscommand = self.slic3r_sliceoptscommand
   !    self.onecmd('button 5 "Slic3r" /c green useSlic3r')
   !    self.onecmd('button 4 "S3rPlater" /c lightgrey s3rPlater')
   !except:
   !  self.statusbar.SetStatusText(_("Failed to set default skeiner!"))
   !  pass

set xy_feedrate 3000
set z_feedrate 300
set e_feedrate 100
set last_temperature 177.0
set last_bed_temperature 78.0
set temperature_abs 220
set bedtemp_abs 110
set temperature_pla 183
set bedtemp_pla 78
set build_dimensions 200.00x200.00x125.00+0.00+0.00+0.00+0.00+0.00+0.00

set last_window_maximized False
set last_window_width 1035
set last_window_height 736
set baudrate 115200
set extruders 2
set tempgauges True
set lockbox True
set last_sash_position 467
set monitor True
set custom1 1

button 0 "Fan off" /c "lightgrey" fanoff
button 1 "Fan 30%" /c "lightgrey" fan70
button 2 "Fan 50%" /c "lightgrey" fan120
button 3 "Fan 100%" /c "lightgrey" fan255
button 4 "X2Merge" /c "lightgrey" x2Merge
button 5 "Slic3r" /c "lightgrey" useSlic3r
button 6 "Skeinforge" /c "lightgrey" useSkeinforge

set last_file_path .
set recentfiles []
